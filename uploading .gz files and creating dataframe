"""This method will be good for small file sizes"""
import pandas as pd
import gzip
import os

def creating_dataframe(id, seq, quality,df):
    mdf = pd.DataFrame({'id': id, 'Sequence': seq, 'Quality': quality})
    df = pd.concat([df, mdf], axis=0)
    id.clear(), seq.clear(), quality.clear()
    return df

df = pd.DataFrame(columns=['id', 'Sequence', 'Quality'])
id, quality, seq = [], [], []
folder = r'New folder'
list_of_files = os.listdir(folder)

for file in list_of_files:
    file_name = folder + str('\\') + str(file) #gererates path to file

    with gzip.open(file_name, 'rt', encoding='utf-8') as data:

        try:
            for strings in data:
                id.append(strings.strip())
                seq.append(data.readline().strip())
                data.readline()
                quality.append(data.readline().strip())

        except EOFError:         #if the file is corrupted

            if len(id)>len(seq):        #integrity check, if not replace loss with 0
                seq.append('0')
                quality.append('0')
            else:
                quality.append('0')

        df = creating_dataframe(id, seq, quality,df)
