import pandas as pd
import gzip
import os


df = pd.DataFrame(columns = ['id', 'Sequence', 'Quality', 'Length'])

records, quality, seq, length = [], [], [], []

folder=r'New folder'

list_of_files = os.listdir(folder)

for file in list_of_files:

    file_name = folder+str('\\') + str(file)

    with gzip.open(file_name, 'rt', encoding='utf-8') as f:

        n=0

        try:
        
            for record in f:

                records.append(record.strip())

                seq.append(f.readline().strip())

                length.append(len(seq[-1]))

                f.readline()

                quality.append(f.readline().strip())


        except EOFError:

            continue


        mdf = pd.DataFrame({'id': records, 'Sequence': seq, 'Quality': quality,'Length': length})

        df = pd.concat([df, mdf], axis=0)


        records.clear()
        quality.clear()
        seq.clear()
        length.clear()











