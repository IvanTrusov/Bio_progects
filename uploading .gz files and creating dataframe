import pandas as pd
import gzip
import os


df = pd.DataFrame(columns = ['id', 'Sequence', 'Quality'])

id, quality, seq = [], [], []


folder=r'New folder'

list_of_files = os.listdir(folder)

for file in list_of_files:

    file_name = folder+str('\\') + str(file)

    with gzip.open(file_name, 'rt', encoding='utf-8') as f:
    

        try:
            file_fastq=f.read().splitlines()

            id = file_fastq[0::4]

            seq = file_fastq[1::4]

            quality = file_fastq[3::4]


        except EOFError:

            continue


        mdf = pd.DataFrame({'id': id, 'Sequence': seq, 'Quality': quality})

        df = pd.concat([df, mdf], axis=0)


        id.clear()
        quality.clear()
        seq.clear()
